---
import { getEntryCTM } from "@/lib/contentParser.astro";
import overrideObjects from "@/lib/utils/overrideObjects.ts";
import { markdownify } from "@/lib/utils/textConverter";
import type { Section } from "@/types";

// Type for this section data
type trainingHRDFSectionType = Section & {
  headline: string;
  bodyCopy: string;
};

type Props = {
  content?: trainingHRDFSectionType;
};

// Fetching the default content for this section
let defaultContent = (
  await getEntryCTM("sections", "training-hrdf", Astro.currentLocale)
)?.data as trainingHRDFSectionType;

// Enables content customization with a fallback to 'defaultContent' if not provided
let actualContent = overrideObjects(
  { ...defaultContent },
  Astro.props.content,
) as trainingHRDFSectionType;

// Extracting required values from 'content' object
let {
  enable = true,
  headline,
  bodyCopy,
} = actualContent as trainingHRDFSectionType;
---

{
  enable && (
    <section class="section py-0 pt-12 md:pt-16 lg:pt-20">
      <div class="container">
        <div class="relative overflow-hidden rounded-2xl bg-primary px-8 py-16 text-white md:px-16 lg:py-24">
          <div class="relative z-10 flex flex-wrap items-center gap-8 lg:flex-nowrap lg:gap-12">
            {headline && (
              <div class="shrink-0 lg:max-w-md">
                <h2 class="text-white text-h3 md:text-h2" set:html={markdownify(headline)} />
              </div>
            )}
            {bodyCopy && (
              <div class="flex-1 min-w-0">
                <div
                  class="content mb-0 text-lg opacity-90"
                  set:html={markdownify(bodyCopy, true)}
                />
              </div>
            )}
          </div>
          
          <!-- Background Pattern -->
          <div class="absolute right-0 top-0 -mr-16 -mt-16 h-64 w-64 rounded-full bg-white/5 blur-3xl"></div>
          <div class="absolute bottom-0 left-0 -mb-16 -ml-16 h-64 w-64 rounded-full bg-white/5 blur-3xl"></div>
        </div>
      </div>
    </section>
  )
}

